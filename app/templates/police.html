<!DOCTYPE html>
<html>
<head>
    <title>Police / Compliance Records</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .filters { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #eb3349; color: white; }
        .back { display: inline-block; margin-bottom: 20px; color: #eb3349; text-decoration: none; font-weight: bold; }
        button { background: #eb3349; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-right: 10px; }
        button:hover { opacity: 0.9; }
        input[type="date"] { padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-right: 10px; }
        .inside { color: orange; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back">‚Üê Back to Login</a>
        
        <div class="header">
            <h1>üëÆ Police / Compliance Records</h1>
            <p>Customer Entry/Exit Log for Regulatory Compliance</p>
        </div>
        
	<div class="filters">
	    <h3>Filter by Period (Starting from Selected Date)</h3>
	    <form>
	        <input type="date" name="date" value="{{ date }}" onchange="updateDate(this.value)">
	        <button type="button" onclick="filterPeriod('day')">1 Day</button>
	        <button type="button" onclick="filterPeriod('week')">1 Week</button>
	        <button type="button" onclick="filterPeriod('month')">1 Month</button>
	        <button type="button" onclick="filterPeriod('3months')">3 Months</button>
	        <button type="button" onclick="filterPeriod('6months')">6 Months</button>
	    </form>
	</div>
        
        <div class="card">
            <h3>Records for {{ period }} starting {{ date }} ({{ records|length }} entries)</h3>
            <table>
                <tr>
                    <th>Name</th>
                    <th>ID (NRIC/FIN/Passport)</th>
                    <th>Nationality</th>
                    <th>Entry Time</th>
                    <th>Exit Time</th>
                    <th>Duration</th>
                </tr>
                {% for r in records %}
                <tr>
                    <td>{{ r[0] }}</td>
                    <td>{{ r[1] }}</td>
                    <td>{{ r[2] }}</td>
                    <td>{{ r[3].strftime('%Y-%m-%d %H:%M') if r[3] else '-' }}</td>
                    <td>{% if r[4] %}{{ r[4].strftime('%Y-%m-%d %H:%M') }}{% else %}<span class="inside">Still inside</span>{% endif %}</td>
                    <td>
                        {% if r[4] and r[3] %}
                            {{ ((r[4] - r[3]).total_seconds() // 3600)|int }}h {{ (((r[4] - r[3]).total_seconds() % 3600) // 60)|int }}m
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    
    <script>
        let currentDate = '{{ date }}';
        
        function updateDate(date) {
            currentDate = date;
        }
        
        function filterPeriod(period) {
            window.location.href = '/police/' + period + '/' + currentDate;
        }
    </script>
</body>
</html>